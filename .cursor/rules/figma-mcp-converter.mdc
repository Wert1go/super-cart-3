---
alwaysApply: false
---
# Figma MCP to React Converter Rule

## Scope
This rule applies when converting Figma designs to React components using MCP (Model Context Protocol).

## Purpose
Ensure consistent, modular, and maintainable React component architecture when converting designs from Figma.

---

## Step 1: Ingest Figma via MCP

### What to Extract
- Frame hierarchy and dimensions
- Component instances and their variants
- Text content and styles (font, size, weight, color)
- Colors and fills
- Auto Layout properties (direction, gap, padding, alignment)
- All image assets (product photos, icons, backgrounds)

### Capture Device Dimensions
- Record the root frame dimensions (e.g., 390x844 for iPhone 14)
- These become the base dimensions for the replica viewport
- All internal measurements are relative to these dimensions

---

## Step 2: Download Assets (CRITICAL)

### Rules
- Download ALL images from Figma MCP
- Never use placeholder URLs
- Save files with descriptive kebab-case names
- Organize assets by type (screens, components, icons)

### Asset Organization
```
Assets/
└── figma/
    ├── screens/           # Full screen reference images
    ├── components/        # Component images
    └── icons/             # Icons and UI elements
```

### Asset Naming Convention
- Use kebab-case: `product-image-1.png`, `cart-icon.png`
- Include index for multiple similar items: `recommended-product-1.png`
- Be descriptive: `delivery-progress-bar.png` not `image-5.png`

### Path References in Code
- Always use relative paths from HTML root: `Assets/figma/icons/plus-icon.png`
- Never use absolute URLs or placeholder services
- Never embed base64 in code

---

## Step 3: Normalize into UI Objects

### UI Object Files
- Store in `src/ui-objects/`
- One file per screen: `src/ui-objects/screens/<ScreenName>.ui.json`
- One file per reusable component: `src/ui-objects/components/<ComponentName>.ui.json`

### Required UI Object Fields
```json
{
  "name": "ScreenName",
  "figmaNodeId": "123:456",
  "figmaFileKey": "abc123",
  "dimensions": { "width": 390, "height": 844 },
  "structure": {
    "fixedTop": ["SafeAreaTop", "StatusBar", "Header"],
    "scrollableContent": ["Section1", "Section2"],
    "fixedBottom": ["PrimaryCTA", "TabBar", "SafeAreaBottom"]
  }
}
```

### Structure Classification (CRITICAL)
Classify every element into one of three layers:
- **fixedTop** - Does NOT scroll (status bar, header)
- **scrollableContent** - Scrolls internally
- **fixedBottom** - Does NOT scroll (CTA, tab bar)

---

## Step 4: Implement Layout Structure

### HTML/JSX Structure Template
```jsx
<DeviceFrame>
  {/* FIXED TOP */}
  <SafeAreaTop />
  <StatusBar />
  <Header />
  
  {/* SCROLLABLE CONTENT */}
  <div className="content-area">
    <Section1 />
    <Section2 />
  </div>
  
  {/* FIXED BOTTOM */}
  <PrimaryCTA />
  <TabBar />
  <SafeAreaBottom />
</DeviceFrame>
```

### CSS Structure
```css
.app-viewport {
  width: 428px;
  height: 926px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.content-area {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}
```

---

## Step 5: Modular Component Architecture

### Rules
- Create one folder per component containing JSX, CSS, and index.js
- Organize components by role: ui, layout, feature-specific
- Use barrel exports (index.js) for clean imports
- Extract constants to dedicated files
- Extract utilities to dedicated files
- Screens must only compose components, not define them inline

### Project Structure
```
src/
├── components/
│   ├── ui/                    # Atomic UI primitives
│   │   ├── Badge/
│   │   │   ├── Badge.jsx
│   │   │   ├── Badge.css
│   │   │   └── index.js
│   │   ├── Toggle/
│   │   ├── ProgressBar/
│   │   └── index.js           # Barrel export
│   │
│   ├── layout/                # Structural components
│   │   ├── DeviceFrame/
│   │   ├── StatusBar/
│   │   ├── Header/
│   │   ├── TabBar/
│   │   ├── SafeArea/
│   │   └── index.js
│   │
│   └── [feature]/             # Feature-specific components
│       ├── FeatureComponent1/
│       ├── FeatureComponent2/
│       └── index.js
│
├── screens/                   # Screen compositions
│   └── ScreenName/
│       ├── ScreenName.jsx
│       ├── ScreenName.css
│       └── index.js
│
├── constants/                 # Business constants
│   └── [domain].js
│
├── utils/                     # Utility functions
│   ├── formatPrice.js
│   └── index.js
│
└── styles/                    # Global styles
    └── global.css
```

### Component Classification

**UI Primitives (`ui/`):**
- Components without business logic
- Reusable across any project
- Examples: Badge, Toggle, Button, Input, ProgressBar

**Layout Components (`layout/`):**
- Screen structure components
- Device frame and safe areas
- Navigation elements
- Examples: DeviceFrame, StatusBar, Header, TabBar, SafeArea

**Feature Components (`[feature]/`):**
- Components with business context
- Named by domain (cart/, profile/, catalog/)
- Examples: CartItem, ProductCard, CheckoutButton

### Barrel Export Pattern
```javascript
// src/components/ui/index.js
export { Badge } from './Badge';
export { Toggle } from './Toggle';
export { ProgressBar } from './ProgressBar';
```

### Component Folder Structure
```
ComponentName/
├── ComponentName.jsx    # Component logic and markup
├── ComponentName.css    # Component-scoped styles
└── index.js             # Re-export for clean imports
```

### Examples

Good:
```
src/components/
├── ui/
│   ├── Badge/
│   │   ├── Badge.jsx
│   │   ├── Badge.css
│   │   └── index.js
│   └── index.js
├── layout/
│   ├── Header/
│   │   ├── Header.jsx
│   │   ├── Header.css
│   │   └── index.js
│   └── index.js
└── cart/
    ├── CartItem/
    └── index.js
```

```jsx
// Clean imports via barrel exports
import { Badge, Toggle } from '../components/ui';
import { Header, TabBar } from '../components/layout';
import { CartItem } from '../components/cart';
```

Bad:
```jsx
// All components in single file - monolithic
const CartScreen = () => {
  const Badge = () => <span>...</span>;
  const Header = () => <header>...</header>;
  const CartItem = () => <div>...</div>;
  // 500+ lines of inline components
};
```

```
// Flat structure without organization
src/components/
├── Badge.jsx
├── Header.jsx
├── CartItem.jsx
├── Toggle.jsx
├── TabBar.jsx
└── ... 20 more files
```

---

## Design Tokens

### Token File Location
`src/design/tokens.json`

### Required Token Categories
```json
{
  "colors": {
    "background": "#f8f8f8",
    "surface": "#ffffff",
    "separator": "#e5e5ea",
    "textPrimary": "#000000",
    "textSecondary": "#8e8e93"
  },
  "typography": {
    "headingLarge": { "size": 28, "weight": 700 },
    "body": { "size": 17, "weight": 400 }
  },
  "spacing": { "xs": 4, "sm": 8, "md": 16, "lg": 20 },
  "radii": { "sm": 8, "md": 12, "lg": 16 }
}
```

---

## Quality Checklist

Before considering a screen complete:

- [ ] All images downloaded to `Assets/figma/`
- [ ] All image paths reference local files
- [ ] Components organized by role (ui/layout/feature)
- [ ] Each component has own folder with JSX, CSS, index.js
- [ ] Barrel exports configured for each category
- [ ] Constants extracted to `src/constants/`
- [ ] Utilities extracted to `src/utils/`
- [ ] Screen only composes components
- [ ] Three-layer architecture implemented
- [ ] Touch targets minimum 44x44px

---

## Examples

### Asset Download

Good:
```javascript
const imageData = await mcp.getAsset(nodeId);
await fs.writeFile('Assets/figma/components/product-image-1.png', imageData);

// Reference in code
<img src="Assets/figma/components/product-image-1.png" alt="product" />
```

Bad:
```javascript
<img src="https://via.placeholder.com/80x80" alt="product" />
<img src="http://localhost:3845/assets/temp-xyz" alt="product" />
```

### Structure Classification

Good:
```json
{
  "structure": {
    "fixedTop": ["SafeAreaTop", "StatusBar", "Header"],
    "scrollableContent": ["Section1", "Section2"],
    "fixedBottom": ["PrimaryCTA", "TabBar", "SafeAreaBottom"]
  }
}
```

Bad:
```json
{
  "components": ["Header", "Section1", "TabBar"]
}
```

### Token Usage

Good:
```css
.card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
}
```

Bad:
```css
.card {
  background: white;
  border-radius: 16px;
  padding: 20px;
}
```

---

## Constraints
- Never use placeholder URLs for assets
- Never embed base64 assets in code
- Never skip the normalization step
- Never put fixed elements inside scrollable content
- Never define components inline within screens
- Never create flat component structures without categorization
